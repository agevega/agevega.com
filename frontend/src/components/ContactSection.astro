---

---

<section id="contact" class="py-20 relative">
  <div class="container mx-auto px-4">
    <div class="max-w-2xl mx-auto">
      <div class="text-center mb-10">
        <h2 class="text-3xl font-bold text-white mb-4">
          ¿En qué podemos colaborar?
        </h2>
        <p class="text-slate-400">
          Déjame tus datos y cuéntame acerca de tu proyecto para que pueda
          revisar tu caso personalmente.
        </p>
      </div>

      <form
        id="contact-form"
        class="space-y-6 bg-slate-800/50 p-8 rounded-2xl border border-slate-700/50 backdrop-blur-sm"
      >
        <!-- Honeypot field for anti-spam (visually hidden but technically present) -->
        <div
          class="opacity-0 absolute top-0 left-0 -z-50 pointer-events-none h-0 w-0 overflow-hidden"
          aria-hidden="true"
        >
          <label for="b_name_hp">Don't fill this out if you're human:</label>
          <input
            type="text"
            name="b_name_hp"
            id="b_name_hp"
            tabindex="-1"
            autocomplete="off"
          />
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label
              for="name"
              class="block text-sm font-medium text-slate-300 mb-2"
              >Nombre</label
            >
            <input
              type="text"
              id="name"
              name="name"
              required
              maxlength="60"
              class="w-full px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-white placeholder-slate-500 transition-colors"
              placeholder="Tu nombre"
            />
          </div>
          <div>
            <label
              for="email"
              class="block text-sm font-medium text-slate-300 mb-2">Email</label
            >
            <input
              type="email"
              id="email"
              name="email"
              required
              maxlength="100"
              class="w-full px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-white placeholder-slate-500 transition-colors"
              placeholder="tu@email.com"
            />
          </div>
        </div>

        <div>
          <label
            for="subject"
            class="block text-sm font-medium text-slate-300 mb-2">Asunto</label
          >
          <input
            type="text"
            id="subject"
            name="subject"
            required
            maxlength="100"
            class="w-full px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-white placeholder-slate-500 transition-colors"
            placeholder="Resumen de tu consulta"
          />
        </div>

        <div>
          <label
            for="message"
            class="block text-sm font-medium text-slate-300 mb-2">Mensaje</label
          >
          <textarea
            id="message"
            name="message"
            rows="4"
            required
            maxlength="2000"
            class="w-full px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-white placeholder-slate-500 transition-colors resize-none"
            placeholder="Describe tu caso o duda..."></textarea>
        </div>

        <div id="form-feedback" class="text-center text-sm hidden font-medium">
        </div>

        <button
          type="submit"
          id="submit-btn"
          class="w-full bg-indigo-600 text-white font-semibold py-4 px-8 rounded-lg hover:bg-indigo-700 transition-all duration-300 transform hover:scale-[1.02] shadow-lg hover:shadow-indigo-500/25 disabled:opacity-50 disabled:cursor-not-allowed"
        >
          Abrir Ticket de Consulta
        </button>
      </form>

      <div class="mt-12 flex justify-center space-x-8">
        <a
          href="https://github.com/agevega"
          target="_blank"
          rel="noopener noreferrer"
          class="text-slate-400 hover:text-white transition-colors"
        >
          GitHub
        </a>
        <a
          href="https://www.linkedin.com/in/alejandro-vega94/"
          target="_blank"
          rel="noopener noreferrer"
          class="text-slate-400 hover:text-white transition-colors"
        >
          LinkedIn
        </a>
      </div>
    </div>
  </div>
</section>

<script>
  const API_URL =
    "https://dbinr2vf90.execute-api.eu-south-2.amazonaws.com/send"; // Real API URL from Terraform

  const form = document.getElementById("contact-form") as HTMLFormElement;
  const submitBtn = document.getElementById("submit-btn") as HTMLButtonElement;
  const feedback = document.getElementById("form-feedback") as HTMLDivElement;

  if (form) {
    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      // Basic Honeypot check
      const honeypot = (
        document.getElementById("b_name_hp") as HTMLInputElement
      )?.value;
      if (honeypot) {
        // Silently fail (or log spam attempt)
        console.warn("Spam detected via honeypot.");
        return;
      }

      // Reset feedback
      feedback.classList.add("hidden");
      feedback.innerHTML = ""; // Clear content completely
      feedback.classList.remove(
        "text-red-400",
        "text-green-400",
        "text-indigo-400"
      );

      // Loading state
      submitBtn.disabled = true;
      submitBtn.innerHTML = "Abriendo ticket...";
      feedback.textContent = "Abriendo ticket...";
      feedback.classList.add("text-indigo-400");
      feedback.classList.remove("hidden");

      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());
      delete data.b_name_hp; // Don't send honeypot field

      try {
        const response = await fetch(API_URL, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(data),
        });

        if (response.ok) {
          feedback.textContent = "¡Ticket abierto con éxito! Hablamos pronto.";
          feedback.classList.replace("text-indigo-400", "text-green-400");
          form.reset();
        } else {
          throw new Error("Server returned " + response.status);
        }
      } catch (error) {
        console.error("Submission error:", error);
        feedback.textContent =
          "Vaya, algo falló al abrir el ticket. Por favor, inténtalo de nuevo.";
        feedback.classList.replace("text-indigo-400", "text-red-400");
      } finally {
        submitBtn.disabled = false;
        submitBtn.innerHTML = "Abrir Ticket de Consulta";
      }
    });
  }
</script>
